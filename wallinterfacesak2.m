%W7
% xxx=((0.1)*sigmas):((0.1)*sigmas):(95*(0.5)*sigmas);
xxx=0.1:0.1:144;
yyy=0.1:0.1:144;
sigmas=21.7;
Amplitude2=zeros(length(xxx),2);
% dummy=fliplr(xxx');
% Amplitude2(:,1)=(2*pi)./dummy;
Amplitude2(:,1)=(2*pi)/(144*(0.5)*(sigmas)):(2*pi)/(144*(0.5)*(sigmas)):2*pi/((0.1)*(0.5)*(sigmas));
for i=1:1:9
     filename=strcat('D:\Newdataanalysis\Finalcoordinateswall\W7tawalldata-FinalCoordinates',num2str(i),'.mat');
     load(filename);
     v=genvarname([strcat('coordinates',num2str(i))]);
     eval([v '=FinalCoordinates;']);
end
FinalCoordinates=[];
f=find(coordinates1(:,2));
coordinates1=coordinates1(f,1:3);
n=max(coordinates1(:,3));
f=find(coordinates2(:,2));
coordinates2=coordinates2(f,1:3);
f=find(coordinates3(:,2));
coordinates3=coordinates3(f,1:3);
f=find(coordinates4(:,2));
coordinates4=coordinates4(f,1:3);
f=find(coordinates5(:,2));
coordinates5=coordinates5(f,1:3);
f=find(coordinates6(:,2));
coordinates6=coordinates6(f,1:3);
f=find(coordinates7(:,2));
coordinates7=coordinates7(f,1:3);
f=find(coordinates8(:,2));
coordinates8=coordinates8(f,1:3);
f=find(coordinates9(:,2));
coordinates9=coordinates9(f,1:3);
yaverage1=[];
yaverage1(1,1)=mean(coordinates1(:,2));
yaverage1(2,1)=mean(coordinates2(:,2));
yaverage1(3,1)=mean(coordinates3(:,2));
yaverage1(4,1)=mean(coordinates4(:,2));
yaverage1(5,1)=mean(coordinates5(:,2));
yaverage1(6,1)=mean(coordinates6(:,2));
yaverage1(7,1)=mean(coordinates7(:,2));
yaverage1(8,1)=mean(coordinates8(:,2));
yaverage1(9,1)=mean(coordinates9(:,2));
yaverage=mean(yaverage1);
for i=1:1:n
    finalcoordinatesy=[];
    f=find(coordinates1(:,3)==i);
    coordinates11=coordinates1(f,1:2);
    f=find(coordinates2(:,3)==i);
    coordinates22=coordinates2(f,1:2);
    f=find(coordinates3(:,3)==i);
    coordinates33=coordinates3(f,1:2);
    f=find(coordinates4(:,3)==i);
    coordinates44=coordinates4(f,1:2);
    f=find(coordinates5(:,3)==i);
    coordinates55=coordinates5(f,1:2);
    f=find(coordinates6(:,3)==i);
    coordinates66=coordinates6(f,1:2);
    f=find(coordinates7(:,3)==i);
    coordinates77=coordinates7(f,1:2);
    f=find(coordinates8(:,3)==i);
    coordinates88=coordinates8(f,1:2);
    f=find(coordinates9(:,3)==i);
    coordinates99=coordinates9(f,1:2);
    finalcoordinatesy(:,1)=interp1(coordinates11(:,1),coordinates11(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,2)=interp1(coordinates22(:,1),coordinates22(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,3)=interp1(coordinates33(:,1),coordinates33(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,4)=interp1(coordinates44(:,1),coordinates44(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,5)=interp1(coordinates55(:,1),coordinates55(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,6)=interp1(coordinates66(:,1),coordinates66(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,7)=interp1(coordinates77(:,1),coordinates77(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,8)=interp1(coordinates88(:,1),coordinates88(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,9)=interp1(coordinates99(:,1),coordinates99(:,2),yyy,'linear','extrap');
    finalcoordinates=[];
    finalcoordinates(:,1)=xxx';
    finalcoordinates(:,2)=sum(finalcoordinatesy,2);
    finalcoordinates(:,2)=finalcoordinates(:,2)/9;
    finalcoordinates(:,3)=finalcoordinates(:,1)*(0.5)*sigmas;
    finalcoordinates(:,4)=finalcoordinates(:,2)*(0.5)*sigmas;
    finalcoordinates(:,5)=i;
    FinalCoordinates=vertcat(FinalCoordinates,finalcoordinates);
    %fourier transform analysis
    finalcoordinates1=[];
    finalcoordinates1(:,1)=finalcoordinates(:,3);
    finalcoordinates1(:,2)=(finalcoordinates(:,2)-yaverage)*(0.5)*(sigmas);
    F=fft(finalcoordinates1(:,2));
    Z=(abs(F));
    Z=Z.^2;
    Amplitude2(:,2)=Amplitude2(:,2)+Z;
end
Amplitude2(:,2)=Amplitude2(:,2)/n;
filename='D:\Newdataanalysis\Ak2-wall\W7.mat';
save(filename);

clearvars
%W2
% xxx=((0.1)*sigmas):((0.1)*sigmas):(95*(0.5)*sigmas);
xxx=0.1:0.1:144;
yyy=0.1:0.1:144;
sigmas=21.7;
Amplitude2=zeros(length(xxx),2);
% dummy=fliplr(xxx');
% Amplitude2(:,1)=(2*pi)./dummy;
Amplitude2(:,1)=(2*pi)/(144*(0.5)*(sigmas)):(2*pi)/(144*(0.5)*(sigmas)):2*pi/((0.1)*(0.5)*(sigmas));
for i=1:1:9
%      filename=strcat('D:\Newdataanalysis\Finalcoordinateswall\W2tawalldata-FinalCoordinates',num2str(i),'.mat');
    filename=strcat('D:\Newdataanalysis\W210tstar\W2-shiftedinterface10tstar',num2str(i),'.mat');    
    load(filename);
    v=genvarname([strcat('coordinates',num2str(i))]);
    eval([v '=FinalCoordinates;']);
end
FinalCoordinates=[];
f=find(coordinates1(:,2));
coordinates1=coordinates1(f,1:3);
n=max(coordinates1(:,3));
f=find(coordinates2(:,2));
coordinates2=coordinates2(f,1:3);
f=find(coordinates3(:,2));
coordinates3=coordinates3(f,1:3);
f=find(coordinates4(:,2));
coordinates4=coordinates4(f,1:3);
f=find(coordinates5(:,2));
coordinates5=coordinates5(f,1:3);
f=find(coordinates6(:,2));
coordinates6=coordinates6(f,1:3);
f=find(coordinates7(:,2));
coordinates7=coordinates7(f,1:3);
f=find(coordinates8(:,2));
coordinates8=coordinates8(f,1:3);
f=find(coordinates9(:,2));
coordinates9=coordinates9(f,1:3);
yaverage1=[];
yaverage1(1,1)=mean(coordinates1(:,2));
yaverage1(2,1)=mean(coordinates2(:,2));
yaverage1(3,1)=mean(coordinates3(:,2));
yaverage1(4,1)=mean(coordinates4(:,2));
yaverage1(5,1)=mean(coordinates5(:,2));
yaverage1(6,1)=mean(coordinates6(:,2));
yaverage1(7,1)=mean(coordinates7(:,2));
yaverage1(8,1)=mean(coordinates8(:,2));
yaverage1(9,1)=mean(coordinates9(:,2));
yaverage=mean(yaverage1);
for i=1:1:n
    finalcoordinatesy=[];
    f=find(coordinates1(:,3)==i);
    coordinates11=coordinates1(f,1:2);
    f=find(coordinates2(:,3)==i);
    coordinates22=coordinates2(f,1:2);
    f=find(coordinates3(:,3)==i);
    coordinates33=coordinates3(f,1:2);
    f=find(coordinates4(:,3)==i);
    coordinates44=coordinates4(f,1:2);
    f=find(coordinates5(:,3)==i);
    coordinates55=coordinates5(f,1:2);
    f=find(coordinates6(:,3)==i);
    coordinates66=coordinates6(f,1:2);
    f=find(coordinates7(:,3)==i);
    coordinates77=coordinates7(f,1:2);
    f=find(coordinates8(:,3)==i);
    coordinates88=coordinates8(f,1:2);
    f=find(coordinates9(:,3)==i);
    coordinates99=coordinates9(f,1:2);
    finalcoordinatesy(:,1)=interp1(coordinates11(:,1),coordinates11(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,2)=interp1(coordinates22(:,1),coordinates22(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,3)=interp1(coordinates33(:,1),coordinates33(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,4)=interp1(coordinates44(:,1),coordinates44(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,5)=interp1(coordinates55(:,1),coordinates55(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,6)=interp1(coordinates66(:,1),coordinates66(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,7)=interp1(coordinates77(:,1),coordinates77(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,8)=interp1(coordinates88(:,1),coordinates88(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,9)=interp1(coordinates99(:,1),coordinates99(:,2),yyy,'linear','extrap');
    finalcoordinates=[];
    finalcoordinates(:,1)=xxx';
    finalcoordinates(:,2)=sum(finalcoordinatesy,2);
    finalcoordinates(:,2)=finalcoordinates(:,2)/9;
    finalcoordinates(:,3)=finalcoordinates(:,1)*(0.5)*sigmas;
    finalcoordinates(:,4)=finalcoordinates(:,2)*(0.5)*sigmas;
    finalcoordinates(:,5)=i;
    FinalCoordinates=vertcat(FinalCoordinates,finalcoordinates);
    %fourier transform analysis
    finalcoordinates1=[];
    finalcoordinates1(:,1)=finalcoordinates(:,3);
    finalcoordinates1(:,2)=(finalcoordinates(:,2)-yaverage)*(0.5)*(sigmas);
    F=fft(finalcoordinates1(:,2));
    Z=(abs(F));
    Z=Z.^2;
    Amplitude2(:,2)=Amplitude2(:,2)+Z;
end
Amplitude2(:,2)=Amplitude2(:,2)/n;
filename='D:\Newdataanalysis\Ak2-wall\W2.mat';
save(filename);

clearvars
%W8
% xxx=((0.1)*sigmas):((0.1)*sigmas):(95*(0.5)*sigmas);
xxx=0.1:0.1:144;
yyy=0.1:0.1:144;
sigmas=21.7;
Amplitude2=zeros(length(xxx),2);
% dummy=fliplr(xxx');
% Amplitude2(:,1)=(2*pi)./dummy;
Amplitude2(:,1)=(2*pi)/(144*(0.5)*(sigmas)):(2*pi)/(144*(0.5)*(sigmas)):2*pi/((0.1)*(0.5)*(sigmas));
for i=1:1:9
     filename=strcat('D:\Newdataanalysis\Finalcoordinateswall\W8tawalldata-FinalCoordinates',num2str(i),'.mat');
     load(filename);
     v=genvarname([strcat('coordinates',num2str(i))]);
     eval([v '=FinalCoordinates;']);
end
FinalCoordinates=[];
f=find(coordinates1(:,2));
coordinates1=coordinates1(f,1:3);
n=max(coordinates1(:,3));
f=find(coordinates2(:,2));
coordinates2=coordinates2(f,1:3);
f=find(coordinates3(:,2));
coordinates3=coordinates3(f,1:3);
f=find(coordinates4(:,2));
coordinates4=coordinates4(f,1:3);
f=find(coordinates5(:,2));
coordinates5=coordinates5(f,1:3);
f=find(coordinates6(:,2));
coordinates6=coordinates6(f,1:3);
f=find(coordinates7(:,2));
coordinates7=coordinates7(f,1:3);
f=find(coordinates8(:,2));
coordinates8=coordinates8(f,1:3);
f=find(coordinates9(:,2));
coordinates9=coordinates9(f,1:3);
yaverage1=[];
yaverage1(1,1)=mean(coordinates1(:,2));
yaverage1(2,1)=mean(coordinates2(:,2));
yaverage1(3,1)=mean(coordinates3(:,2));
yaverage1(4,1)=mean(coordinates4(:,2));
yaverage1(5,1)=mean(coordinates5(:,2));
yaverage1(6,1)=mean(coordinates6(:,2));
yaverage1(7,1)=mean(coordinates7(:,2));
yaverage1(8,1)=mean(coordinates8(:,2));
yaverage1(9,1)=mean(coordinates9(:,2));
yaverage=mean(yaverage1);
for i=1:1:n
    finalcoordinatesy=[];
    f=find(coordinates1(:,3)==i);
    coordinates11=coordinates1(f,1:2);
    f=find(coordinates2(:,3)==i);
    coordinates22=coordinates2(f,1:2);
    f=find(coordinates3(:,3)==i);
    coordinates33=coordinates3(f,1:2);
    f=find(coordinates4(:,3)==i);
    coordinates44=coordinates4(f,1:2);
    f=find(coordinates5(:,3)==i);
    coordinates55=coordinates5(f,1:2);
    f=find(coordinates6(:,3)==i);
    coordinates66=coordinates6(f,1:2);
    f=find(coordinates7(:,3)==i);
    coordinates77=coordinates7(f,1:2);
    f=find(coordinates8(:,3)==i);
    coordinates88=coordinates8(f,1:2);
    f=find(coordinates9(:,3)==i);
    coordinates99=coordinates9(f,1:2);
    finalcoordinatesy(:,1)=interp1(coordinates11(:,1),coordinates11(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,2)=interp1(coordinates22(:,1),coordinates22(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,3)=interp1(coordinates33(:,1),coordinates33(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,4)=interp1(coordinates44(:,1),coordinates44(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,5)=interp1(coordinates55(:,1),coordinates55(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,6)=interp1(coordinates66(:,1),coordinates66(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,7)=interp1(coordinates77(:,1),coordinates77(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,8)=interp1(coordinates88(:,1),coordinates88(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,9)=interp1(coordinates99(:,1),coordinates99(:,2),yyy,'linear','extrap');
    finalcoordinates=[];
    finalcoordinates(:,1)=xxx';
    finalcoordinates(:,2)=sum(finalcoordinatesy,2);
    finalcoordinates(:,2)=finalcoordinates(:,2)/9;
    finalcoordinates(:,3)=finalcoordinates(:,1)*(0.5)*sigmas;
    finalcoordinates(:,4)=finalcoordinates(:,2)*(0.5)*sigmas;
    finalcoordinates(:,5)=i;
    FinalCoordinates=vertcat(FinalCoordinates,finalcoordinates);
    %fourier transform analysis
    finalcoordinates1=[];
    finalcoordinates1(:,1)=finalcoordinates(:,3);
    finalcoordinates1(:,2)=(finalcoordinates(:,2)-yaverage)*(0.5)*(sigmas);
    F=fft(finalcoordinates1(:,2));
    Z=(abs(F));
    Z=Z.^2;
    Amplitude2(:,2)=Amplitude2(:,2)+Z;
end
Amplitude2(:,2)=Amplitude2(:,2)/(n-(2*t));
filename='D:\Newdataanalysis\Ak2-wall\W8.mat';
save(filename);

clearvars
%W5
% xxx=((0.1)*sigmas):((0.1)*sigmas):(95*(0.5)*sigmas);
xxx=0.1:0.1:144;
yyy=0.1:0.1:144;
sigmas=21.7;
Amplitude2=zeros(length(xxx),2);
% dummy=fliplr(xxx');
% Amplitude2(:,1)=(2*pi)./dummy;
Amplitude2(:,1)=(2*pi)/(144*(0.5)*(sigmas)):(2*pi)/(144*(0.5)*(sigmas)):2*pi/((0.1)*(0.5)*(sigmas));
for i=1:1:9
     filename=strcat('D:\Newdataanalysis\Finalcoordinateswall\W5tawalldata-FinalCoordinates',num2str(i),'.mat');
     load(filename);
     v=genvarname([strcat('coordinates',num2str(i))]);
     eval([v '=FinalCoordinates;']);
end
FinalCoordinates=[];
f=find(coordinates1(:,2));
coordinates1=coordinates1(f,1:3);
n=max(coordinates1(:,3));
f=find(coordinates2(:,2));
coordinates2=coordinates2(f,1:3);
f=find(coordinates3(:,2));
coordinates3=coordinates3(f,1:3);
f=find(coordinates4(:,2));
coordinates4=coordinates4(f,1:3);
f=find(coordinates5(:,2));
coordinates5=coordinates5(f,1:3);
f=find(coordinates6(:,2));
coordinates6=coordinates6(f,1:3);
f=find(coordinates7(:,2));
coordinates7=coordinates7(f,1:3);
f=find(coordinates8(:,2));
coordinates8=coordinates8(f,1:3);
f=find(coordinates9(:,2));
coordinates9=coordinates9(f,1:3);
yaverage1=[];
yaverage1(1,1)=mean(coordinates1(:,2));
yaverage1(2,1)=mean(coordinates2(:,2));
yaverage1(3,1)=mean(coordinates3(:,2));
yaverage1(4,1)=mean(coordinates4(:,2));
yaverage1(5,1)=mean(coordinates5(:,2));
yaverage1(6,1)=mean(coordinates6(:,2));
yaverage1(7,1)=mean(coordinates7(:,2));
yaverage1(8,1)=mean(coordinates8(:,2));
yaverage1(9,1)=mean(coordinates9(:,2));
yaverage=mean(yaverage1);
for i=1:1:n
    finalcoordinatesy=[];
    f=find(coordinates1(:,3)==i);
    coordinates11=coordinates1(f,1:2);
    f=find(coordinates2(:,3)==i);
    coordinates22=coordinates2(f,1:2);
    f=find(coordinates3(:,3)==i);
    coordinates33=coordinates3(f,1:2);
    f=find(coordinates4(:,3)==i);
    coordinates44=coordinates4(f,1:2);
    f=find(coordinates5(:,3)==i);
    coordinates55=coordinates5(f,1:2);
    f=find(coordinates6(:,3)==i);
    coordinates66=coordinates6(f,1:2);
    f=find(coordinates7(:,3)==i);
    coordinates77=coordinates7(f,1:2);
    f=find(coordinates8(:,3)==i);
    coordinates88=coordinates8(f,1:2);
    f=find(coordinates9(:,3)==i);
    coordinates99=coordinates9(f,1:2);
    finalcoordinatesy(:,1)=interp1(coordinates11(:,1),coordinates11(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,2)=interp1(coordinates22(:,1),coordinates22(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,3)=interp1(coordinates33(:,1),coordinates33(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,4)=interp1(coordinates44(:,1),coordinates44(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,5)=interp1(coordinates55(:,1),coordinates55(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,6)=interp1(coordinates66(:,1),coordinates66(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,7)=interp1(coordinates77(:,1),coordinates77(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,8)=interp1(coordinates88(:,1),coordinates88(:,2),yyy,'linear','extrap');
    finalcoordinatesy(:,9)=interp1(coordinates99(:,1),coordinates99(:,2),yyy,'linear','extrap');
    finalcoordinates=[];
    finalcoordinates(:,1)=xxx';
    finalcoordinates(:,2)=sum(finalcoordinatesy,2);
    finalcoordinates(:,2)=finalcoordinates(:,2)/9;
    finalcoordinates(:,3)=finalcoordinates(:,1)*(0.5)*sigmas;
    finalcoordinates(:,4)=finalcoordinates(:,2)*(0.5)*sigmas;
    finalcoordinates(:,5)=i;
    FinalCoordinates=vertcat(FinalCoordinates,finalcoordinates);
    %fourier transform analysis
    finalcoordinates1=[];
    finalcoordinates1(:,1)=finalcoordinates(:,3);
    finalcoordinates1(:,2)=(finalcoordinates(:,2)-yaverage)*(0.5)*(sigmas);
    F=fft(finalcoordinates1(:,2));
    Z=(abs(F));
    Z=Z.^2;
    Amplitude2(:,2)=Amplitude2(:,2)+Z;
end
Amplitude2(:,2)=Amplitude2(:,2)/(n-(2*t));
filename='D:\Newdataanalysis\Ak2-wall\W5.mat';
save(filename);